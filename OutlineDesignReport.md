## 版本历史

| 版本 | 作者 | 更新日期 | 更新说明 |
| ---- | ---- | -------- | -------- |
|      |      |          |          |

## 目录

[TOC]

## 1 文档介绍

### 1.1 文档目的

本文档给出“大学生活动发布与社交平台”产品“一苇以航”的整体概述，对于产品的各项功能进行系统描述，明确该产品的定位，用作之后系统测试的基础，同时也作为完成后验收确认的依据。

### 1.2 文档范围

该文档介绍活动发布系统的微信小程序，后端以及Web端的功能及其实现方式，错误处理等。

### 1.3 读者对象

本文档面向用户、开发人员、产品人员和验收方。

### 1.4 参考文献

**提示：**列出本文档的所有参考文献（可以是非正式出版物），格式如下：

[编号] 作者，文献名称，出版单位（或归属单位），日期

| 编号          | 作者           | 文档名称                   | 单位                                                         | 日期       |
| ------------- | -------------- | -------------------------- | ------------------------------------------------------------ | ---------- |
| GB/T9235-2008 | 冯慧、王宝艾等 | 计算机软件需求规格说明规范 | 中华人民共和国国家质量监督检验检疫总局、中国国家标准化管理委员会 | 2008-04-11 |

例如：

[SPP-PROC-PP]SEPG，需求开发规范，机构名称，日期

### 1.5 术语与缩写解释

| 缩写、术语                          | 解释                                                         |
| ----------------------------------- | ------------------------------------------------------------ |
| 版块(Forum)                         | 活动的顶层分类，例如博雅、社团活动、志愿等，由超级管理员设定，无法随意添加或修改 |
| 组织(Organization, ORG)             | 从属于版块，由用户创建、经过审核后发布，创建者自动成为组织管理员 |
| 活动(Activity, ACT)                 | 从属于组织（社团、学生会等版块下）或版块（博雅、演出等官方版块，以及*个人版块*），由组织/个人发布 |
| 固定活动(Official Activity, OA)     | 具有（一定的）官方性质的活动，例如博雅、演出等，由超级管理员通过爬虫等渠道获取并更新至活动列表，不归特定组织所有 |
| 非固定活动(Unofficial Activity, UA) | 包括*组织活动*（由组织管理员代表组织发布）及*个人活动*（由个人发布），例如社团活动、约球约自习等 |



## 2 设计要点

**提示：**描述文档组织结构，列举影响模块设计的关键点，包括：

*1.*    *本设计报告的范围。*

*2.*    *关键业务功能。引用《需求规格书》中对应功能的描述，并说明如何实现。*

*3.*    *技术实现难点。通常来源于非功能性需求，如：性能、数据规模、可靠性等。*

*4.*  *影响设计的其他考虑，如：外购产品、扩展性、参数化、可维护性、数据规模、性能等。*





## 3 功能分组1 实现设计    普通用户

**提示：**本章内容应包括对“需求规格书”中功能的实现说明。实现方法应与设计要点中的约定保持一致。此处可增加表格方式展示实现的功能列表。

*如：*

![image-20210409155043721](OutlineDesignReport/image-20210409155043721.png)



### 3.1 功能A1（编号）实现 

**提示：”功能A1”**是对“需求规格书”中对应功能编号和名称的引用。描述下列内容：

*1.*    前提条件。应在原有功能的“输入/前提条件”基础上加以细化，约定对前提条件的检查方法。

*2.*    功能实现步骤。应在原有功能的“操作序列”基础上加以细化。

*3.*    后继结果。应在原有功能的“输出/后继结果”基础上加以细化。

*4.*    定义在上述内容中出现的数据及接口。包括：数据库、数据接口、通讯接口，至少要定义名称。

*5.*    如需引用其他文档定义的数据及接口(**如外部接口)**，应明确写出其名称、接口编号或对应文档章节号。



#### 3.1.1 实现简述及约定  

**提示：**

描述该功能实现的设计思路和设计约定。



#### 3.1.2 功能实现流程

**提示：**绘制流程图(**必要)**、时序图(**可选)**、状态图（可选）等展示功能实现设计的细节。图形均建议采用VISO绘制。

当流程中有多个子系统、多个对象时，采用跨职能流程图绘制。

如需描述该子系统与其他子系统的一般性交互关系，可绘制简要时序图。

如存在较复杂的状态控制，可绘制状态图。

对于图中关键步骤，应辅以文字说明。



#### 3.2.3 用户界面设计

**提示：**介绍本功能用户界面的关键输入、输出项目。每个界面应具有界面编号，界面构成可采用下表进行描述：

| **NO** | **类型** | **信息内容**   | **信息表现**     | **说明**                                   |
| ------ | -------- | -------------- | ---------------- | ------------------------------------------ |
| 1      | 必选     | 对话框名称     | 字符提示         | 遵循字符要求  显示在窗体菜单栏上           |
| 2      | 可选     | 系统自检项状态 | 字符或者图片提示 | 遵循字符、图片提示要求  显示自检项通过情况 |

输  出：1）自检通过，迁移到登录界面（LCWS_E01_001）； 

补充说明： 



#### 3.1.4 相关接口

**提示：**列举本功能实现涉及到的接口，通常对于接口详细定义和说明，会提供单独的接口文档加以描述，本节中可以采用列表方式来进行引用，并适当说明其用法。

| 序号 | 类型 | 接口编号/名称 | 来源/文档编号 | 说明 |
| ---- | ---- | ------------- | ------------- | ---- |
| 1.   | 内部 |               |               |      |
| 2.   | 外部 |               |               |      |
| 3.   | UI   |               |               |      |



#### 3.1.5 出错处理设计

**提示：**说明功能执行过程中可能的异常、错误情况，并说明异常处理方法。



#### 3.1.6 出错信息

**提示：**用一览表的方式说明每种可能的出错或故障情况出现时，系统输出信息的形式、含意及处理方法。

| 序号 | 错误编码 | 错误信息 | 说明/处理办法 |
| ---- | -------- | -------- | ------------- |
| 1.   |          |          |               |





## 4 功能分组2 实现设计   组织管理员



## 5 功能分组3 实现设计   组织负责人



## 6 功能分组3 实现设计  超级管理员



## 7 接口设计

**提示：**说明本功能实现涉及到的接口，通常对于接口详细定义和说明，会提供单独的接口文档加以描述，本节中可以采用列表方式来进行引用，并适当说明其用法。如需定义新接口，则在本节中定义。

本节内容可选。

| 序号 | 类型 | 接口编号/名称 | 来源/文档编号 | 说明 |
| ---- | ---- | ------------- | ------------- | ---- |
| 1.   | 内部 |               |               |      |
| 2.   | 外部 |               |               |      |
| 3.   | UI   |               |               |      |



### 5.1 接口1（接口编号）定义

**提示：**描述接口方式、用途。定义接口格式。可采用与数据结构定义中的表格形式，或者给出顺序图。

| 序号 | 字段     | 长度 | 类型 | 说明 |
| ---- | -------- | ---- | ---- | ---- |
| 1    | 字段名称 |      | BCD  |      |
| 2    |          |      | HEX  |      |



## 8 数据结构设计

**提示：**说明本文档涉及的数据结构(数据库表)。

### 8.1 微信用户 WXUser

| 序号 | 字段   | 含义              | 长度  | 类型       | 说明                                         |
| ---- | ------ | ----------------- | ----- | ---------- | -------------------------------------------- |
| 1    | openid | 微信小程序open id | 1-500 | CharField  | 微信小程序认证登录时，每位用户自动生成openid |
| 2    | name   | 用户昵称          | 1-30  | CharField  | 微信认证登录用户微信昵称                     |
| 3    | avatar | 用户头像url       | 1-500 | CharField  | 微信用户头像url地址                          |
| 4    | email  | 邮箱              | 1-100 | EmailField | 认证北航邮箱                                 |
| 5    | sign   | 签名              | 1-200 | CharField  | 个性签名                                     |

### 8.2 活动Activity

| 序号 | 字段        | 含义         | 长度  | 类型          | 说明                              |
| ---- | ----------- | ------------ | ----- | ------------- | --------------------------------- |
| 1    | name        | 活动名称     | 1-100 | CharField     |                                   |
| 2    | begin_time  | 活动开始时间 |       | DateTimeField |                                   |
| 3    | end_time    | 活动结束时间 |       | DateTimeField |                                   |
| 4    | pub_time    | 活动发布时间 |       | DateTimeField | 活动发布时自动生成                |
| 5    | contain     | 人数限制     |       | CharField     | 活动最大人数限制，默认为0         |
| 6    | description | 活动描述     | 1-500 | CharField     | 活动描述                          |
| 7    | review      | 是否需要审核 |       | BooleanField  | 默认为False                       |
| 8    | owner       | 活动发起人   |       | ForeignKey    | WXUser，发布活动的人自动成为owner |
| 9    | type        | 活动类型     |       | ForeignKey    | Category                          |
| 10   | org         | 活动所属组织 |       | ForeignKey    | Organization                      |
| 11   | location    | 活动地点     |       | ForeignKey    | Address                           |

### 8.3 用户参加活动表 JoinedAct

| 序号 | 字段   | 含义 | 长度 | 类型       | 说明     |
| ---- | ------ | ---- | ---- | ---------- | -------- |
| 1    | act    | 活动 |      | ForeignKey | Activity |
| 2    | person | 用户 |      | ForeignKey | WXUser   |

### 8.4 活动类别Category

| 序号 | 字段 | 含义     | 长度 | 类型      | 说明 |
| ---- | ---- | -------- | ---- | --------- | ---- |
| 1    | name | 类别名称 | 1-50 | CharField |      |

### 8.5 地址Address

| 序号 | 字段      | 含义     | 长度            | 类型         | 说明 |
| ---- | --------- | -------- | --------------- | ------------ | ---- |
| 1    | name      | 地址名称 | 1-50            | CharField    |      |
| 2    | longitude | 经度     | 10，小数点后6位 | DecimalField |      |
| 3    | latitude  | 纬度     | 10，小数点后6位 | DecimalField |      |

### 8.6 组织 Organization

| 序号 | 字段        | 含义         | 长度  | 类型          | 说明                 |
| ---- | ----------- | ------------ | ----- | ------------- | -------------------- |
| 1    | name        | 组织名称     | 1-50  | CharField     |                      |
| 2    | description | 组织描述     | 1-500 | CharField     |                      |
| 3    | create_time | 组织创建时间 |       | DateTimeField | 组织被创建时自动生成 |
| 4    | avatar      | 组织头像     |       | CharField     | 对应前端url地址      |
| 5    | owner       | 组织负责人   |       | ForeignKey    | WXUser               |
| 6    | block       | 所属板块     |       | ForeignKey    | Block                |

### 8.7 组织管理员OrgManager

| 序号 | 字段   | 含义 | 长度 | 类型       | 说明         |
| ---- | ------ | ---- | ---- | ---------- | ------------ |
| 1    | org    | 组织 |      | ForeignKey | Organization |
| 2    | person | 用户 |      | ForeignKey | WXUser       |

### 8.8 关注组织表FollowedOrg

| 序号 | 字段   | 含义 | 长度 | 类型       | 说明         |
| ---- | ------ | ---- | ---- | ---------- | ------------ |
| 1    | org    | 组织 |      | ForeignKey | Organization |
| 2    | person | 用户 |      | ForeignKey | WXUser       |

### 8.9 评价Comment

| 序号 | 字段     | 含义     | 长度  | 类型          | 说明               |
| ---- | -------- | -------- | ----- | ------------- | ------------------ |
| 1    | content  | 评价内容 | 1-500 | CharField     |                    |
| 2    | pub_time | 发布时间 |       | DateTimeField | 随评论发布自动生成 |
| 3    | score    | 评分     |       | IntegerField  |                    |
| 4    | act      | 活动     |       | ForeignKey    | Activity           |
| 5    | person   | 用户     |       | ForeignKey    | WXUser             |

### 8.10 组织模块 Block

| 序号 | 字段 | 含义     | 长度 | 类型      | 说明 |
| ---- | ---- | -------- | ---- | --------- | ---- |
| 1    | name | 类别名称 | 1-50 | CharField |      |

### 8.11 组织管理员申请 ManagerApplication

| 序号 | 字段     | 含义     | 长度  | 类型          | 说明               |
| ---- | -------- | -------- | ----- | ------------- | ------------------ |
| 1    | org      | 组织     |       | ForeignKey    | Organization       |
| 2    | user     | 用户     |       | ForeignKey    | WXUser             |
| 3    | content  | 申请理由 | 1-500 | CharField     |                    |
| 4    | pub_time | 申请时间 |       | DateTimeField | 随评论发布自动生成 |

### 8.12 组织申请OrgApplication

| 序号 | 字段        | 含义     | 长度  | 类型              | 说明                                                      |
| ---- | ----------- | -------- | ----- | ----------------- | --------------------------------------------------------- |
| 1    | name        | 组织名称 | 1-50  | CharField         |                                                           |
| 2    | description | 组织描述 | 1-500 | CharField         |                                                           |
| 3    | pub_time    | 申请时间 |       | DateTimeField     | 发出申请时自动生成                                        |
| 4    | status      | 申请状态 |       | SmallIntegerField | (0, '待审批'),     (1, '审批通过'),     (2, '审批未通过') |
| 5    | user        | 申请用户 |       | ForeignKey        | WXUser                                                    |
| 6    | block       | 所属板块 |       | ForeignKey        | Block                                                     |

### 8.13 加入活动申请表JoinActApplication

| 序号 | 字段 | 含义 | 长度 | 类型       | 说明     |
| ---- | ---- | ---- | ---- | ---------- | -------- |
| 1    | act  | 活动 |      | ForeignKey | Activity |
| 2    | user | 用户 |      | ForeignKey | WXUser   |

### 8.14 超级管理员 SuperUser

| 序号 | 字段     | 含义     | 长度  | 类型       | 说明            |
| ---- | -------- | -------- | ----- | ---------- | --------------- |
| 1    | name     | 昵称     |       | CharField  |                 |
| 2    | avatar   | 用户头像 | 1-500 | CharField  | 用户头像url地址 |
| 3    | email    | 邮箱     | 1-100 | EmailField | 邮箱            |
| 4    | password | 密码     |       | CharField  |                 |

### 8.15 管理日志Log

| 序号 | 字段     | 含义     | 长度  | 类型          | 说明     |
| ---- | -------- | -------- | ----- | ------------- | -------- |
| 1    | content  | 操作内容 | 1-500 | CharField     |          |
| 2    | pub_time | 操作时间 |       | DateTimeField | 自动生成 |

### 8.16 用户反馈UserFeedback

| 序号 | 字段     | 含义     | 长度  | 类型          | 说明     |
| ---- | -------- | -------- | ----- | ------------- | -------- |
| 1    | content  | 内容     | 1-500 | CharField     |          |
| 2    | pub_time | 发布时间 |       | DateTimeField | 自动生成 |
| 3    | user     | 用户     |       | ForeignKey    | WXUser   |

### 8.17 数据库关系图



<img src="后端E-R图\BUAA.png"  />

